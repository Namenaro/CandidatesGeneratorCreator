from candidates_selection.step_constructor import Step
from settings import TYPES_OF_STEP, FREQUENCY

from typing import List
import numpy as np

class GlobalMax(Step):
    """Берется максимум сигнала внутри интервала, включающего обе границы.  если глобальных максисмумов много, берется самый левый"""
    type_of_step = TYPES_OF_STEP.candidates
    comment = "Максимум сигнала"

    def __init__(self):
        pass

    def run(self, signal, left, right)->List[float]:
        """
        Берется максимум сигнала внтри интервала, включающего обе границы
        :param signal:
        :param left:
        :param right:
        :return: координата победителя, [float]
        """
        int_coord_left, int_coord_right = Step.get_borders_as_ints(left, right=right, signal=signal)
        if int_coord_left is None:
            return []  # нкакая-то проблема с интервалом рассмотрения

        segment = signal[int_coord_left:int_coord_right + 1]
        max_val = max(segment)
        max_index = int_coord_left + segment.index(max_val)

        return [max_index/FREQUENCY]

if __name__ == "__main__":
    step = GlobalMax()
    signal = [np.float64(-0.0106342953031646), np.float64(-0.011027101022679776), np.float64(-0.011723689300601511), np.float64(-0.012566799856055246), np.float64(-0.013371400718072224), np.float64(-0.013978960305321184), np.float64(-0.014305822965119532), np.float64(-0.014360739766249912), np.float64(-0.014220073672175159), np.float64(-0.013975389895095069), np.float64(-0.013681088771199364), np.float64(-0.013320567854320184), np.float64(-0.012798633885763033), np.float64(-0.01197280266370884), np.float64(-0.010729987901895324), np.float64(-0.009080803290354714), np.float64(-0.007208839428620132), np.float64(-0.005421874796244399), np.float64(-0.004017662109653107), np.float64(-0.003146493638477383), np.float64(-0.0027606147233676936), np.float64(-0.0026804769721745663), np.float64(-0.002724931823827944), np.float64(-0.0028130837112475804), np.float64(-0.0029796481026040664), np.float64(-0.0033139592785465183), np.float64(-0.0038790304396214975), np.float64(-0.004661720250517456), np.float64(-0.005568923122640443), np.float64(-0.006457916233885905), np.float64(-0.007183835587605394), np.float64(-0.00764977196020223), np.float64(-0.007842789983398662), np.float64(-0.007837509680207543), np.float64(-0.00775928043060309), np.float64(-0.0077223688738730315), np.float64(-0.007776572778240709), np.float64(-0.00789377387290024), np.float64(-0.008004648605477727), np.float64(-0.008064244126384637), np.float64(-0.008101004053383268), np.float64(-0.008211249542180478), np.float64(-0.0084990294310782), np.float64(-0.009004324067534484), np.float64(-0.009671562166440054), np.float64(-0.010377748669276213), np.float64(-0.010997307424869195), np.float64(-0.011457105500661275), np.float64(-0.01175170063701078), np.float64(-0.01191992991763678), np.float64(-0.012005325722360101), np.float64(-0.012020092936670643), np.float64(-0.011924748357539617), np.float64(-0.011631565207938632), np.float64(-0.011037755934004965), np.float64(-0.010079826110085632), np.float64(-0.008781798908157636), np.float64(-0.007263197674990717), np.float64(-0.005696356153818199), np.float64(-0.004235580646323549), np.float64(-0.002959324066142706), np.float64(-0.0018581506432324558), np.float64(-0.0008685487837450843), np.float64(7.74891566830709e-05), np.float64(0.0010233989456347452), np.float64(0.0019931315898807957), np.float64(0.0030146782581346922), np.float64(0.0041344065779282055), np.float64(0.00540467979074892), np.float64(0.006852948888830089), np.float64(0.008456653971184667), np.float64(0.010145084314680784), np.float64(0.011826467612312336), np.float64(0.013420152748730811), np.float64(0.014877652626871823), np.float64(0.016194455134611464), np.float64(0.017418831423181687), np.float64(0.01865035859467356), np.float64(0.02001308871761536), np.float64(0.021608810658654692), np.float64(0.023478152164257755), np.float64(0.025595057464663826), np.float64(0.02789421260691214), np.float64(0.03030742560066154), np.float64(0.03278814668066089), np.float64(0.03531442439586139), np.float64(0.03787128644540766), np.float64(0.040418802123328094), np.float64(0.04286331649230417), np.float64(0.04506078319248329), np.float64(0.046870337945382735), np.float64(0.04823745207502698), np.float64(0.04924806748631963), np.float64(0.05010274290945853), np.float64(0.051016818179061785), np.float64(0.05211220983135997), np.float64(0.053374182306573245), np.float64(0.05469096782039512), np.float64(0.05593163001596832), np.float64(0.05699680137245511), np.float64(0.05781559713136217), np.float64(0.058309731070157675), np.float64(0.058362076418162184), np.float64(0.05780954181855417), np.float64(0.05645945940202475), np.float64(0.05412396196930035), np.float64(0.0506685199637881), np.float64(0.046060294482446355), np.float64(0.04039262714176927), np.float64(0.033871110083614375), np.float64(0.026772700766906146), np.float64(0.019403157592952778), np.float64(0.012067611710617649), np.float64(0.005050177670434205), np.float64(-0.001403917952546428), np.float64(-0.007104707877316851), np.float64(-0.01193327446787109), np.float64(-0.015857215614748458), np.float64(-0.018933987334325317), np.float64(-0.021286068006763446), np.float64(-0.0230476262101061), np.float64(-0.024316649722846813), np.float64(-0.02514895034771249), np.float64(-0.02559685292806637), np.float64(-0.02575666667794719), np.float64(-0.025787035753762403), np.float64(-0.02589478980034089), np.float64(-0.026287704420565716), np.float64(-0.027107635384746923), np.float64(-0.028336347307579696), np.float64(-0.029711885780962843), np.float64(-0.030719010986640007), np.float64(-0.03078560527249135), np.float64(-0.029693845159487274), np.float64(-0.027964591998718914), np.float64(-0.02680984367678311), np.float64(-0.027494978883082548), np.float64(-0.030475052320760962), np.float64(-0.035015432744155583), np.float64(-0.03964310513148528), np.float64(-0.043055575256066916), np.float64(-0.04477959882624285), np.float64(-0.045175523911445), np.float64(-0.044999885824325646), np.float64(-0.045026051925226636), np.float64(-0.04600187335942863), np.float64(-0.04875390472802481), np.float64(-0.054028592646267595), np.float64(-0.06191248481086542), np.float64(-0.07109259678498192), np.float64(-0.0785899570261402), np.float64(-0.08036883720895602), np.float64(-0.07263254546091294), np.float64(-0.05296787417674273), np.float64(-0.02065829644680904), np.float64(0.023804131708201372), np.float64(0.07939762531613202), np.float64(0.14491310518640238), np.float64(0.2189242872130603), np.float64(0.299673113818979), np.float64(0.38493292174795823), np.float64(0.47176870520933517), np.float64(0.5562901664208787), np.float64(0.6337133481675619), np.float64(0.6988826776720757), np.float64(0.747062723021355), np.float64(0.7746509931265555), np.float64(0.7795430668955059), np.float64(0.761102295128002), np.float64(0.7199232304271797), np.float64(0.6576342015883232), np.float64(0.5769521568179357), np.float64(0.4819688317460626), np.float64(0.37843612029179), np.float64(0.2735222595215087), np.float64(0.1747269453098736), np.float64(0.08824684952579122), np.float64(0.01765031644905435), np.float64(-0.03638495148759527), np.float64(-0.07521054689013465), np.float64(-0.10091800813787186), np.float64(-0.11547223194452874), np.float64(-0.12061868902425248), np.float64(-0.11821997786564137), np.float64(-0.11050964401685437), np.float64(-0.0999547162249856), np.float64(-0.08879363939113014), np.float64(-0.07849356439179506), np.float64(-0.06943681055426874), np.float64(-0.061056734889079464), np.float64(-0.052461986504214325), np.float64(-0.04331503023817427), np.float64(-0.03436557105667009), np.float64(-0.02715216452218711), np.float64(-0.023025237530232008), np.float64(-0.022259341143594347), np.float64(-0.023983777142691027), np.float64(-0.0268665061815168), np.float64(-0.0298466311631708), np.float64(-0.0322983905936427), np.float64(-0.033769955336972565), np.float64(-0.03384702081094886), np.float64(-0.032341100008785734), np.float64(-0.02950156466300681), np.float64(-0.02597096828032254), np.float64(-0.02252433734205425), np.float64(-0.019806676976973223), np.float64(-0.01816406203763829), np.float64(-0.017585986895767305), np.float64(-0.017749663027832978), np.float64(-0.01815944092665712), np.float64(-0.01831686213903224), np.float64(-0.01782382306323119), np.float64(-0.01643808803049026), np.float64(-0.014100025422722092), np.float64(-0.010959915481189686), np.float64(-0.007363765655117555), np.float64(-0.0037571451028331156), np.float64(-0.0005373720587742885), np.float64(0.002080137655085406), np.float64(0.004101327391748516), np.float64(0.005690129815285145), np.float64(0.007059295263165486), np.float64(0.0083835336508795), np.float64(0.009765976171242863), np.float64(0.011249067158857678), np.float64(0.012846529646233645), np.float64(0.014577153192496601), np.float64(0.01648604156183065), np.float64(0.018643740896317325), np.float64(0.021119756896851763), np.float64(0.023943820262407184), np.float64(0.027080988285908304), np.float64(0.030439244537028017), np.float64(0.03390410844504946), np.float64(0.03737435108062949), np.float64(0.04077958084508259), np.float64(0.04407651270734562), np.float64(0.04723234889279873), np.float64(0.050203252150385284), np.float64(0.05291943072941192), np.float64(0.055294049317952995), np.float64(0.05726727671762774), np.float64(0.058866654400043184), np.float64(0.060241437155361774), np.float64(0.061635518707240156), np.float64(0.06330355027893737), np.float64(0.06541401093719025), np.float64(0.06799792727385377), np.float64(0.07097294247881106), np.float64(0.07422609897192092), np.float64(0.07770313026608594), np.float64(0.08145341142393603), np.float64(0.08560961159075678), np.float64(0.09031764500508074), np.float64(0.09565571175862081), np.float64(0.10158421390310515), np.float64(0.10795451328842226), np.float64(0.11457844737878296), np.float64(0.12132320035852179), np.float64(0.12817364684794974), np.float64(0.13521998197694085), np.float64(0.14258231070108368), np.float64(0.15032858507870267), np.float64(0.15843768976421702), np.float64(0.1668144696079829), np.float64(0.17533157317494444), np.float64(0.183873485409424), np.float64(0.19237313668863004), np.float64(0.20083441768961358), np.float64(0.20933864171994848), np.float64(0.2180377774104216), np.float64(0.22713608662676582), np.float64(0.23684703596278495), np.float64(0.2473144309867471), np.float64(0.2585209134381372), np.float64(0.2702447080170504), np.float64(0.2821144197202859), np.float64(0.2937477802911868), np.float64(0.30489340613956817), np.float64(0.3154949162459074), np.float64(0.3256517834763323), np.float64(0.3355168039044919), np.float64(0.34519345804768575), np.float64(0.3546816870925404), np.float64(0.36388981429733314), np.float64(0.3727006387772832), np.float64(0.38105297087995077), np.float64(0.38898966478411817), np.float64(0.3966387449706198), np.float64(0.40413602356526485), np.float64(0.4115357086418555), np.float64(0.41876505766664796), np.float64(0.4256455242476679), np.float64(0.4319565842862546), np.float64(0.43749463102187436), np.float64(0.4421005223069302), np.float64(0.44566353350489474), np.float64(0.4481184550070919), np.float64(0.449434235613007), np.float64(0.4495902899291654), np.float64(0.4485528299512128), np.float64(0.4462773442461252), np.float64(0.4427378210451497), np.float64(0.437953131071792), np.float64(0.43198505216511), np.float64(0.42491802345603885), np.float64(0.4168430328438677), np.float64(0.40785219500789754), np.float64(0.3980352482623964), np.float64(0.3874731993380038), np.float64(0.37622974301937323), np.float64(0.36433947316210613), np.float64(0.35179823603461235), np.float64(0.33857421946714505), np.float64(0.3246500638368118), np.float64(0.310072407875179), np.float64(0.2949654976667005), np.float64(0.27949677435808407), np.float64(0.2638273813242244), np.float64(0.24808961725582557), np.float64(0.23239781566682094), np.float64(0.21686938922577215), np.float64(0.20163252042053897), np.float64(0.18681582483112233), np.float64(0.17252598260148871), np.float64(0.15882082263273167), np.float64(0.14568908583655016), np.float64(0.1330558238062042), np.float64(0.12082245643044366), np.float64(0.10892315041124989), np.float64(0.09736449619159282), np.float64(0.0862270730138391), np.float64(0.07563275841374953), np.float64(0.06569878627903446), np.float64(0.05650262324520865), np.float64(0.04807493591558512), np.float64(0.04042210239500371), np.float64(0.033558472163142034), np.float64(0.027522259162959858), np.float64(0.02236812468454088), np.float64(0.018152309740685938), np.float64(0.01492659854478177), np.float64(0.01273930578210408), np.float64(0.01163268616509006)]
#[np.float64(-0.010489251468022839), np.float64(-0.01093371784269446), np.float64(-0.011676445854251042), np.float64(-0.012552882739250043), np.float64(-0.01341340602708867), np.float64(-0.014057973424584591), np.float64(-0.014398072737381215), np.float64(-0.014434386315928164), np.float64(-0.014284383528349385), np.float64(-0.014063291369175016), np.float64(-0.013803689886693159), np.float64(-0.013450245060901155), np.float64(-0.012927033187760149), np.float64(-0.012087636164424747), np.float64(-0.010790595537618075), np.float64(-0.009075724876745388), np.float64(-0.0071685736022098654), np.float64(-0.0053600469461168795), np.float64(-0.003928938549638475), np.float64(-0.003007394292632167), np.float64(-0.002601211293528559), np.float64(-0.0025078239084354117), np.float64(-0.0025977876738132013), np.float64(-0.002727695057531492), np.float64(-0.002920336354205916), np.float64(-0.0032762967688280877), np.float64(-0.0038425398431239034), np.float64(-0.004641015542995836), np.float64(-0.005570585108639779), np.float64(-0.006501479442131209), np.float64(-0.007251200106806185), np.float64(-0.00772298490522913), np.float64(-0.007897193405762335), np.float64(-0.007874025053938034), np.float64(-0.007811333350782205), np.float64(-0.007751194545351832), np.float64(-0.007777776210959297), np.float64(-0.007877847964408836), np.float64(-0.007945984052063317), np.float64(-0.008012555697540646), np.float64(-0.008058996060749559), np.float64(-0.008174960080727458), np.float64(-0.00847134989656348), np.float64(-0.008990699006285938), np.float64(-0.00964855524931568), np.float64(-0.010364000448224966), np.float64(-0.011023915957478736), np.float64(-0.01150147944213121), np.float64(-0.01179786925796723), np.float64(-0.012000000000000004), np.float64(-0.01209117799957056), np.float64(-0.0121152417194953), np.float64(-0.012035998517899429), np.float64(-0.011759819964501796), np.float64(-0.011149719630799368), np.float64(-0.010168201509711646), np.float64(-0.008844028821249284), np.float64(-0.007310983626157921), np.float64(-0.005701738630418946), np.float64(-0.004228925328205821), np.float64(-0.0029013034475523685), np.float64(-0.0017891891638191233), np.float64(-0.0008175532702635761), np.float64(0.00010571062631269974), np.float64(0.0010076579217503006), np.float64(0.0019315870869584819), np.float64(0.0029475070155112306), np.float64(0.004084960436941742), np.float64(0.005361117836896603), np.float64(0.006793696139512044), np.float64(0.008440260001964971), np.float64(0.010144978305699963), np.float64(0.011852930524207906), np.float64(0.013456576864420606), np.float64(0.014897305289800416), np.float64(0.01621263963854723), np.float64(0.01740337188538143), np.float64(0.018599882818445157), np.float64(0.01993118146481066), np.float64(0.02152965953523836), np.float64(0.023391540845175945), np.float64(0.02550108250822833), np.float64(0.02781320887906706), np.float64(0.03023117221791783), np.float64(0.03274542933078934), np.float64(0.035331301003218074), np.float64(0.03792396241945965), np.float64(0.04053518434440013), np.float64(0.04299607369614915), np.float64(0.04518336750121759), np.float64(0.0469697817941116), np.float64(0.048321459001117006), np.float64(0.049311439948764066), np.float64(0.05015340289699882), np.float64(0.05104837056649192), np.float64(0.05210027654774625), np.float64(0.053341981172473865), np.float64(0.05468896567338377), np.float64(0.055964398416003466), np.float64(0.05711957977929945), np.float64(0.05800172305213375), np.float64(0.05858181233109702), np.float64(0.05869880061302138), np.float64(0.05820728110184377), np.float64(0.05690308324495888), np.float64(0.054612372064819115), np.float64(0.051174554002906714), np.float64(0.04651224961091125), np.float64(0.0407714652743047), np.float64(0.034145368908210474), np.float64(0.026915529139915875), np.float64(0.019423718809457126), np.float64(0.011916015473304724), np.float64(0.004778097602999193), np.float64(-0.0017487065191680276), np.float64(-0.007455397777564699), np.float64(-0.01231483137803339), np.float64(-0.01625842475247851), np.float64(-0.019292076597436543), np.float64(-0.021602002804481775), np.float64(-0.023338713805862527), np.float64(-0.024549319306168316), np.float64(-0.025312544093795256), np.float64(-0.025677495688673235), np.float64(-0.025777032757033927), np.float64(-0.025727534090722357), np.float64(-0.02577355239204579), np.float64(-0.02609793495289911), np.float64(-0.02702519608086215), np.float64(-0.02873510201294841), np.float64(-0.030093726990103098), np.float64(-0.030853812915577428), np.float64(-0.03048708366648626), np.float64(-0.029572083632034653), np.float64(-0.027528322988499783), np.float64(-0.026558080790230296), np.float64(-0.027468706290380552), np.float64(-0.030249999418780846), np.float64(-0.034686025653906966), np.float64(-0.03982930890277659), np.float64(-0.04290993059524771), np.float64(-0.045109334285246286), np.float64(-0.0459253659652), np.float64(-0.045119464299189276), np.float64(-0.044039605337346535), np.float64(-0.04497919171946653), np.float64(-0.047781478384031635), np.float64(-0.053552400704495275), np.float64(-0.0628127808406296), np.float64(-0.0729695086414454), np.float64(-0.08065968096915105), np.float64(-0.08424791324065581), np.float64(-0.07743378044900787), np.float64(-0.058383641346650084), np.float64(-0.026142992708001446), np.float64(0.017927926293387974), np.float64(0.07404835776950584), np.float64(0.14103450663504744), np.float64(0.21585089764366372), np.float64(0.2978040216967416), np.float64(0.38488354174300393), np.float64(0.473387827791956), np.float64(0.5602080001120582), np.float64(0.6395204653566837), np.float64(0.7068761594560625), np.float64(0.7557756981281031), np.float64(0.7850913362550345), np.float64(0.7907563762628644), np.float64(0.771996596836642), np.float64(0.7300626529561118), np.float64(0.6661787065255355), np.float64(0.582709050983039), np.float64(0.4848429822444881), np.float64(0.37866572881253774), np.float64(0.27166446447675013), np.float64(0.1701724275614261), np.float64(0.08249585034651233), np.float64(0.01084702907859809), np.float64(-0.04373560281836809), np.float64(-0.08257321859928944), np.float64(-0.10668851928190051), np.float64(-0.12001410928804092), np.float64(-0.12417496937587566), np.float64(-0.12029707400792462), np.float64(-0.11152762675678235), np.float64(-0.10118012876403676), np.float64(-0.08925656944020091), np.float64(-0.07861123021919537), np.float64(-0.06933168134501595), np.float64(-0.060804445472489324), np.float64(-0.05120630936043837), np.float64(-0.04264413716736919), np.float64(-0.0341899087010145), np.float64(-0.026109337509748295), np.float64(-0.022268738413847747), np.float64(-0.02144897728094875), np.float64(-0.023147901206321597), np.float64(-0.026426352108602703), np.float64(-0.029719658177758033), np.float64(-0.03289206978799994), np.float64(-0.034423835816996345), np.float64(-0.03473549017269426), np.float64(-0.0325567040163761), np.float64(-0.029265289197363733), np.float64(-0.026331758573275407), np.float64(-0.022480570374298806), np.float64(-0.01959694541402974), np.float64(-0.017596399509552954), np.float64(-0.017313844114953222), np.float64(-0.017805713029973122), np.float64(-0.018060957436829596), np.float64(-0.018561287802887617), np.float64(-0.01819057135783628), np.float64(-0.016771308459224615), np.float64(-0.014363444982176714), np.float64(-0.011112424274380743), np.float64(-0.00740466239250825), np.float64(-0.003695147349510419), np.float64(-0.0004059510065496796), np.float64(0.0022471700451861224), np.float64(0.004312001824015907), np.float64(0.005850427400575575), np.float64(0.00715763540415725), np.float64(0.008410590930732442), np.float64(0.00971822912246847), np.float64(0.01117735708973803), np.float64(0.012744189524120838), np.float64(0.014471348278876217), np.float64(0.016346473326116384), np.float64(0.01852652540369479), np.float64(0.020999014070399266), np.float64(0.023817244710103443), np.float64(0.02699058712224786), np.float64(0.030385787731422146), np.float64(0.033865015441481156), np.float64(0.037366038561006225), np.float64(0.04082388271693048), np.float64(0.0441740728388959), np.float64(0.04735196623141004), np.float64(0.05036283691449053), np.float64(0.05307896853547448), np.float64(0.05543851270846484), np.float64(0.057349231390621924), np.float64(0.058901077499812896), np.float64(0.06020955620746198), np.float64(0.06157021772175245), np.float64(0.06321130114410956), np.float64(0.06527086269026164), np.float64(0.06781839378617664), np.float64(0.07079056436482103), np.float64(0.07401329517692622), np.float64(0.0774890294948232), np.float64(0.08123260445077045), np.float64(0.08539819168388274), np.float64(0.09010427470549821), np.float64(0.09547420133509481), np.float64(0.1013903836428339), np.float64(0.1077601413565417), np.float64(0.11442236314421074), np.float64(0.1212026015223002), np.float64(0.12804181914662538), np.float64(0.13510613757099832), np.float64(0.1424689552444055), np.float64(0.15022375705842084), np.float64(0.15833391998542834), np.float64(0.16671011090357224), np.float64(0.17527166524631235), np.float64(0.1838731948439572), np.float64(0.19236468687029967), np.float64(0.20076315727265484), np.float64(0.2091742377802449), np.float64(0.21781782160499263), np.float64(0.2268699176555785), np.float64(0.2365927508157276), np.float64(0.24709877311195966), np.float64(0.25837668520061247), np.float64(0.270193233013614), np.float64(0.28212638869447876), np.float64(0.29382596069075373), np.float64(0.30503698047296035), np.float64(0.31566716970194164), np.float64(0.32587768066620737), np.float64(0.33571048623953925), np.float64(0.3453705307146488), np.float64(0.3548319946044344), np.float64(0.3640396646132902), np.float64(0.3728215551159775), np.float64(0.3811815555133651), np.float64(0.3891244987085326), np.float64(0.39678279797159643), np.float64(0.40428497686297626), np.float64(0.4116961293045714), np.float64(0.41894399030834806), np.float64(0.4259249443745206), np.float64(0.43229646771455166), np.float64(0.43790763658218124), np.float64(0.4425674083035288), np.float64(0.4462184787772856), np.float64(0.44869710637683213), np.float64(0.4500158241976745), np.float64(0.4501697325000505), np.float64(0.44916839526700514), np.float64(0.44688755546688697), np.float64(0.4433209958833514), np.float64(0.4384996754811695), np.float64(0.43252312426853157), np.float64(0.42544510163252086), np.float64(0.4173161574962643), np.float64(0.4082199342257613), np.float64(0.39839291737728727), np.float64(0.3878608415919549), np.float64(0.3765993434277455), np.float64(0.3646633935173894), np.float64(0.3521212988568934), np.float64(0.3388771966896711), np.float64(0.32491965155791275), np.float64(0.31031071131688914), np.float64(0.2951385156239653), np.float64(0.2796204949893263), np.float64(0.26390815673179757), np.float64(0.24806464541673418), np.float64(0.23228438985974176), np.float64(0.21670064496850927), np.float64(0.20143540046143515), np.float64(0.18659623751210808), np.float64(0.17229170154804752), np.float64(0.1585818342156109), np.float64(0.14545445452153147), np.float64(0.13284242795908585), np.float64(0.12061255673141627), np.float64(0.1086815909084129), np.float64(0.09711299718663585), np.float64(0.085985727581718), np.float64(0.07535948109632523), np.float64(0.06536212565101118), np.float64(0.05613227557678438), np.float64(0.047683759899409345), np.float64(0.0400187484187648), np.float64(0.0331303493480412), np.float64(0.027082916723839178), np.float64(0.021909318639750496), np.float64(0.017673772483620596), np.float64(0.014419920140352717), np.float64(0.012195717065257957), np.float64(0.01111213580385794)]
    left = 0
    right = len(signal)/FREQUENCY
    coord = step.run(signal, left, right=right)
    int_coord = int(coord[0]*FREQUENCY)
    print (f" коорд максимума {int_coord}, значение {signal[int_coord]}")